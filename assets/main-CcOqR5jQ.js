(function(){const e=document.createElement("link").relList;if(e&&e.supports&&e.supports("modulepreload"))return;for(const a of document.querySelectorAll('link[rel="modulepreload"]'))s(a);new MutationObserver(a=>{for(const o of a)if(o.type==="childList")for(const l of o.addedNodes)l.tagName==="LINK"&&l.rel==="modulepreload"&&s(l)}).observe(document,{childList:!0,subtree:!0});function n(a){const o={};return a.integrity&&(o.integrity=a.integrity),a.referrerPolicy&&(o.referrerPolicy=a.referrerPolicy),a.crossOrigin==="use-credentials"?o.credentials="include":a.crossOrigin==="anonymous"?o.credentials="omit":o.credentials="same-origin",o}function s(a){if(a.ep)return;a.ep=!0;const o=n(a);fetch(a.href,o)}})();const O=[{name:"Play online",href:"#onLine"},{name:"Play on-site",href:"#onSite"},{name:"The story",href:"#story"},{name:"Contact us",href:"#contact"}],R=document.querySelector(".nav__hamburger"),v=document.querySelector(".nav__menu"),D=document.querySelector(".nav__background"),F=()=>{O.forEach(t=>{const e=document.createElement("li");e.classList.add("nav__menuItem");const n=document.createElement("a");n.href=t.href,n.textContent=t.name,n.classList.add("nav__menuLink"),e.appendChild(n),v.appendChild(e)})},z=()=>{const t=document.createElement("button");t.classList.add("nav__menu__closeBtn");const e=document.createElement("span");e.classList.add("closeSpan1");const n=document.createElement("span");return n.classList.add("closeSpan2"),t.appendChild(e),t.appendChild(n),v.appendChild(t),t},H=z();F();const j=()=>{setTimeout(()=>{v.classList.toggle("nav__menu--active")},200),D.classList.toggle("nav__background--active")},w=()=>{v.classList.remove("nav__menu--active"),D.classList.remove("nav__background--active")};R.addEventListener("click",j);v.addEventListener("click",t=>{t.target.classList.contains("nav__menuLink")&&w()});H.addEventListener("click",w);window.addEventListener("scroll",w);document.addEventListener("DOMContentLoaded",()=>{const t=document.querySelector(".main__btn.online"),e=document.querySelector(".main__btn.onsite");t.addEventListener("click",()=>{window.location.href="challenges.html?type=online"}),e.addEventListener("click",()=>{window.location.href="challenges.html?type=onsite"})});const S="https://lernia-sjj-assignments.vercel.app/api",U=t=>{if(!/^\d{4}-(0[1-9]|1[0-2])-(0[1-9]|[12][0-9]|3[01])$/.test(t))return!1;const n=new Date(t);return n instanceof Date&&!isNaN(n)},Y=t=>/^(?:[01]\d|2[0-3]):[0-5]\d$/.test(t),Z=t=>{const e=new Date;e.setUTCHours(0,0,0,0);const n=new Date(e);return n.setUTCDate(e.getUTCDate()+1),new Date(t)>=n},J=({challengeId:t,name:e,email:n,date:s,time:a,participants:o})=>typeof t!="number"||typeof e!="string"||typeof n!="string"||typeof s!="string"||typeof a!="string"||typeof o!="number"?(console.log("Invalid parameter/s: ",{challengeId:t,name:e,email:n,date:s,time:a,participants:o}),!1):U(s)?Z(s)?Y(a)?!0:(console.log("Invalid 'time': Must be in HH:mm format."),!1):(console.log("Invalid 'date': Booking must be at least tomorrow or later."),!1):(console.log("Invalid 'date': Must be in YYYY-MM-DD format."),!1),k=async(t,e={})=>{try{const n=await fetch(t,e);if(!n.ok){const s=await n.text();throw console.log(`Error response from ${t}:`,s),new Error(`HTTP error! status: ${n.status}, message: ${s}`)}return await n.json()}catch(n){throw console.log(`Error fetching data from ${t}:`,n),n}},I=async()=>{try{const{challenges:t}=await k(`${S}/challenges`);return console.log("Challenges:",t),{success:!0,data:t??[]}}catch(t){return{success:!1,data:[],error:t.message}}},M=async(t,e)=>{if(typeof t!="number"||typeof e!="string")return console.log("Invalid parameters:",{challengeId:t,date:e}),{success:!1,data:[],error:"Invalid parameters"};try{const{slots:n}=await k(`${S}/booking/available-times?date=${e}&challenge=${t}`);return console.log("Available slots:",n),{success:!0,data:n??[]}}catch(n){return{success:!1,data:[],error:n.message}}},_=async t=>{try{const{success:e,data:n,error:s}=await I();if(!e)return console.error("Failed to fetch challenges:",s),{success:!1,data:null,error:s};const a=n.find(o=>o.id===t);return a?(console.log("Found challenge details:",a),{success:!0,data:a}):(console.error(`Challenge with ID ${t} not found.`),{success:!1,data:null,error:"Challenge not found"})}catch(e){return console.error("Error finding challenge details:",e),{success:!1,data:null,error:e.message}}},P=async t=>{if(!J(t))return{success:!1,error:"Invalid input data"};try{const e=await k(`${S}/booking/reservations`,{method:"POST",headers:{"Content-Type":"application/json"},body:JSON.stringify({challenge:t.challengeId,name:t.name,email:t.email,date:t.date,time:t.time,participants:t.participants})});return(e==null?void 0:e.status)==="ok"?(console.log("Booking successful:",e),{success:!0,data:e.booking}):{success:!1,error:"Reservation failed"}}catch(e){return console.log("Error in creating reservation:",e),{success:!1,error:e.message}}};I();M(3,"2024-12-12");_(3);_(3);P({challengeId:3,name:"Elena",email:"elena@elena.com",date:"2025-12-12",time:"15:30",participants:2});const m=document.querySelector("#booking-email"),p=document.querySelector("#booking-name"),A=document.querySelector("#booking-time"),q=document.querySelector("#booking-participants"),y=document.querySelector("#user-booking");let i,d;const b=t=>{alert(t)},K=(t,e)=>{for(;t.options.length>1;)t.remove(1);e.forEach(({value:n,label:s})=>{const a=document.createElement("option");a.value=n,a.textContent=s,t.appendChild(a)})},B=t=>/^[a-zA-Z0-9._%+-]+@[a-zA-Z0-9.-]+\.[a-zA-Z]{2,}$/.test(t),G=async(t,e)=>{if(i=t,d=e,console.log(`Initializing Step 2 with challengeId: ${i}, date: ${d}`),!i||!d){console.error("Missing challengeId or selectedDate in Step 2 initialization");return}try{const n=document.querySelector("#step2 .modal__content-loading"),{success:s,data:a}=await _(i);s&&a.title?n.textContent=a.title:n.textContent="Room Title Not Found",await Q(i),await X(i,d),N(2)}catch(n){console.error("Error initializing Step 2:",n)}},Q=async t=>{try{const{success:e,data:n,error:s}=await _(t);if(e){const{minParticipants:a,maxParticipants:o}=n;console.log("minParticipants:",a,"maxParticipants:",o),W(a,o)}else console.error("Failed to load participants:",s)}catch(e){console.error("Error loading participants:",e)}},W=(t,e)=>{if(!t||!e){console.error("Invalid participant range");return}for(let n=t;n<=e;n++){const s=document.createElement("option");s.value=n.toString(),s.textContent=`${n} participant${n>1?"s":""}`,q.appendChild(s)}console.log("type of participants:",typeof t)},X=async(t,e)=>{try{const{success:n,data:s,error:a}=await M(t,e);if(n){const o=s.map(l=>{const[c,h]=l.split(":").map(Number),r=new Date;r.setHours(c),r.setMinutes(h+90);const f=String(r.getHours()).padStart(2,"0"),u=String(r.getMinutes()).padStart(2,"0"),C=`${f}:${u}`;return{value:l,label:`${l} - ${C}`}});K(A,o)}else console.error("Failed to load available times:",a)}catch(n){console.error("Error loading available times:",n)}},ee=t=>{const e=B(t.target.value);t.target.setCustomValidity(e?"":"Please enter a valid email address.")},te=t=>{const e=t.target.value.trim();e.length===0?t.target.setCustomValidity("Name should not be empty or contain only spaces."):/^[a-zA-Z\s]{2,}$/.test(e)?t.target.setCustomValidity(""):t.target.setCustomValidity("Please enter a valid name (letters only, at least 2 characters).")},ne=async t=>{t.preventDefault(),console.log("Selected Date:",d),console.log("Challenge ID:",i);const e=p.value.trim();if(e.length===0){p.setCustomValidity("Name should not be empty."),p.reportValidity();return}else p.setCustomValidity("");const n=m.value.trim();if(B(n))m.setCustomValidity("");else{m.setCustomValidity("Please enter a valid email address."),m.reportValidity();return}if(!d||!i){b("Missing challenge ID or selected date.");return}const s={challengeId:i,name:e,email:n,date:d,time:y.selected_time.value,participants:parseInt(y.selected_participants.value,10)};try{const{success:a,data:o,error:l}=await P(s);a?(console.log("Reservation created successfully:",o),p.value="",m.value="",A.selectedIndex=0,q.selectedIndex=0,N(3)):(console.error("Failed to create reservation:",l),b("Failed to create reservation. Please try again."))}catch(a){console.error("Error creating reservation:",a),b("An unexpected error occurred. Please try again.")}};document.addEventListener("DOMContentLoaded",()=>{m.addEventListener("input",ee),p.addEventListener("input",te)});y._hasSubmitListener||(y.addEventListener("submit",ne),y._hasSubmitListener=!0);const V=document.querySelector(".booking-modal");document.querySelectorAll(".booking-modal__step");const L=document.querySelector(".custom__date"),E=document.querySelector(".modal__content-loading"),se=document.querySelector(".booking__search-btn"),ae=document.querySelectorAll(".close");let g;const oe=()=>{const t=new Date;t.setDate(t.getDate()+1);const e=t.toISOString().split("T")[0];L.setAttribute("min",e)},N=t=>{document.querySelectorAll(".booking-modal__step").forEach((n,s)=>{s+1===t?(n.style.display="block",n.classList.add("booking-modal__step--active")):(n.style.display="none",n.classList.remove("booking-modal__step--active"))})},le=async t=>{try{const{success:e,data:n}=await _(t);e&&n.title?E.textContent=n.title:E.textContent="Room Title Not Found"}catch(e){E.textContent="Error Loading Room Title",console.error("Error loading room title:",e)}};se.addEventListener("click",async t=>{t.preventDefault();const e=L.value;if(!e){alert("Please select a valid date."),L.focus();return}if(!g){console.error("Error: challengeId is undefined.");return}await G(g,e)});const x=t=>{if(g=t,!g){console.error("No challengeId provided to openBookingModal");return}V.style.display="block",console.log(`Modal is displayed for challengeId: ${g}`),le(g),N(1)};document.addEventListener("DOMContentLoaded",()=>{V.style.display="none",console.log("Modal is hidden when the page is loaded"),oe()});ae.forEach(t=>{t.addEventListener("click",()=>{const e=t.closest(".booking-modal");e.style.display="none"})});class re{constructor(e,n,s,a,o,l,c,h,r){this.id=e,this.title=n,this.description=s,this.type=a,this.minParticipants=o,this.maxParticipants=l,this.rating=c,this.image=h,this.labels=r}createChallengeStars(){const e=this.rating,n=document.createElement("div");n.className="challenge__ratings";for(let s=1;s<=5;s++){const a=new Image;s<=Math.floor(e)?(a.src="assets/svg/star-filled.svg",a.className="star filled"):s===Math.ceil(e)&&e%1!==0?(a.src="assets/svg/star-half.svg",a.className="star half"):(a.src="assets/svg/star.svg",a.className="star unfilled"),n.appendChild(a)}return n}createBookChallengeBtn(){const e=document.createElement("button");return e.className="challenge__btn",this.type==="onsite"?(e.textContent="Book this room",e.addEventListener("click",()=>x(this.id))):this.type==="online"&&(e.textContent="Take challenge online",e.addEventListener("click",()=>x(this.id))),e}createChallengeCard(e){const n=document.createElement("li");n.id="challenges__carousel__slide"+this.id,n.setAttribute("tabindex",0),n.className="challenge__slide challengey challenges";const s=document.createElement("div");s.className="challenge__image-container";const a=document.createElement("img");a.className="challenge__img",a.src=this.image,a.alt=this.description,a.loading="lazy",s.appendChild(a);const o=document.createElement("div");o.className="challenge__details";const l=document.createElement("h2");l.className="challenge__details__title_temporary",l.textContent=this.title+(this.type==="onsite"?" (onsite)":"");const c=document.createElement("div");c.className="challenge__details-info";const h=this.createChallengeStars(),r=document.createElement("div");r.className="challenge__participants",r.textContent=`${this.minParticipants} - ${this.maxParticipants} participants`,this.type==="online"&&(r.textContent+=" (networked)"),s.appendChild(h),c.appendChild(r);const f=document.createElement("p");if(f.className="challenge__description",f.textContent=this.description,o.appendChild(l),this.labels&&this.labels.length>0){const C=this.createLabels();o.appendChild(C)}o.appendChild(c),o.appendChild(f),e&&o.appendChild(this.createBookChallengeBtn());const u=document.createElement("span");return u.className="challenge__type-icon",this.type==="online"?u.textContent="💻":this.type==="onsite"&&(u.textContent="🏠"),s.appendChild(u),n.appendChild(s),n.appendChild(o),n}createLabels(){const e=document.createElement("div");return e.className="challenge__labels",this.labels.forEach(n=>{const s=document.createElement("span");s.className="challenge__label",s.textContent=`*${n} `,e.appendChild(s)}),e}}const ie=(t,e,n=!0)=>{e.innerHTML="",t.forEach(s=>{const o=new re(s.id,s.title,s.description,s.type,s.minParticipants,s.maxParticipants,s.rating,s.image,s.labels).createChallengeCard(n);e.appendChild(o)})},T=document.querySelector(".challenges__list");let $=[];const ce=async()=>{const{success:t,data:e,error:n}=await I();if(!t){console.error("Failed to fetch challenges:",n),T.innerHTML="<li>Error loading challenges. Please try again later.</li>";return}$=e;const a=[...$].sort((o,l)=>l.rating-o.rating).slice(0,3);ie(a,T)};ce();
//# sourceMappingURL=main-CcOqR5jQ.js.map
