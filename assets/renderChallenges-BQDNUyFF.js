import"./menu-BIv-Fo41.js";const E="https://lernia-sjj-assignments.vercel.app/api",P=t=>{if(!/^\d{4}-(0[1-9]|1[0-2])-(0[1-9]|[12][0-9]|3[01])$/.test(t))return!1;const n=new Date(t);return n instanceof Date&&!isNaN(n)},A=t=>/^(?:[01]\d|2[0-3]):[0-5]\d$/.test(t),B=t=>{const e=new Date;e.setUTCHours(0,0,0,0);const n=new Date(e);return n.setUTCDate(e.getUTCDate()+1),new Date(t)>=n},V=({challengeId:t,name:e,email:n,date:a,time:s,participants:o})=>typeof t!="number"||typeof e!="string"||typeof n!="string"||typeof a!="string"||typeof s!="string"||typeof o!="number"?(console.log("Invalid parameter/s: ",{challengeId:t,name:e,email:n,date:a,time:s,participants:o}),!1):P(a)?B(a)?A(s)?!0:(console.log("Invalid 'time': Must be in HH:mm format."),!1):(console.log("Invalid 'date': Booking must be at least tomorrow or later."),!1):(console.log("Invalid 'date': Must be in YYYY-MM-DD format."),!1),x=async(t,e={})=>{try{const n=await fetch(t,e);if(!n.ok){const a=await n.text();throw console.log(`Error response from ${t}:`,a),new Error(`HTTP error! status: ${n.status}, message: ${a}`)}return await n.json()}catch(n){throw console.log(`Error fetching data from ${t}:`,n),n}},L=async()=>{try{const{challenges:t}=await x(`${E}/challenges`);return console.log("Challenges:",t),{success:!0,data:t??[]}}catch(t){return{success:!1,data:[],error:t.message}}},I=async(t,e)=>{if(typeof t!="number"||typeof e!="string")return console.log("Invalid parameters:",{challengeId:t,date:e}),{success:!1,data:[],error:"Invalid parameters"};try{const{slots:n}=await x(`${E}/booking/available-times?date=${e}&challenge=${t}`);return console.log("Available slots:",n),{success:!0,data:n??[]}}catch(n){return{success:!1,data:[],error:n.message}}},y=async t=>{try{const{success:e,data:n,error:a}=await L();if(!e)return console.error("Failed to fetch challenges:",a),{success:!1,data:null,error:a};const s=n.find(o=>o.id===t);return s?(console.log("Found challenge details:",s),{success:!0,data:s}):(console.error(`Challenge with ID ${t} not found.`),{success:!1,data:null,error:"Challenge not found"})}catch(e){return console.error("Error finding challenge details:",e),{success:!1,data:null,error:e.message}}},N=async t=>{if(!V(t))return{success:!1,error:"Invalid input data"};try{const e=await x(`${E}/booking/reservations`,{method:"POST",headers:{"Content-Type":"application/json"},body:JSON.stringify({challenge:t.challengeId,name:t.name,email:t.email,date:t.date,time:t.time,participants:t.participants})});return(e==null?void 0:e.status)==="ok"?(console.log("Booking successful:",e),{success:!0,data:e.booking}):{success:!1,error:"Reservation failed"}}catch(e){return console.log("Error in creating reservation:",e),{success:!1,error:e.message}}};L();I(3,"2024-12-12");y(3);y(3);N({challengeId:3,name:"Elena",email:"elena@elena.com",date:"2025-12-12",time:"15:30",participants:2});const u=document.querySelector("#booking-email"),p=document.querySelector("#booking-name"),T=document.querySelector("#booking-time"),$=document.querySelector("#booking-participants"),C=document.querySelector("#user-booking");let r,d;const b=t=>{alert(t)},q=(t,e)=>{for(;t.options.length>1;)t.remove(1);e.forEach(({value:n,label:a})=>{const s=document.createElement("option");s.value=n,s.textContent=a,t.appendChild(s)})},D=t=>/^[a-zA-Z0-9._%+-]+@[a-zA-Z0-9.-]+\.[a-zA-Z]{2,}$/.test(t),H=async(t,e)=>{if(r=t,d=e,console.log(`Initializing Step 2 with challengeId: ${r}, date: ${d}`),!r||!d){console.error("Missing challengeId or selectedDate in Step 2 initialization");return}try{const n=document.querySelector("#step2 .modal__content-loading"),{success:a,data:s}=await y(r);a&&s.title?n.textContent=s.title:n.textContent="Room Title Not Found",await R(r),await z(r,d),k(2)}catch(n){console.error("Error initializing Step 2:",n)}},R=async t=>{try{const{success:e,data:n,error:a}=await y(t);if(e){const{minParticipants:s,maxParticipants:o}=n;console.log("minParticipants:",s,"maxParticipants:",o),F(s,o)}else console.error("Failed to load participants:",a)}catch(e){console.error("Error loading participants:",e)}},F=(t,e)=>{if(!t||!e){console.error("Invalid participant range");return}for(let n=t;n<=e;n++){const a=document.createElement("option");a.value=n.toString(),a.textContent=`${n} participant${n>1?"s":""}`,$.appendChild(a)}console.log("type of participants:",typeof t)},z=async(t,e)=>{try{const{success:n,data:a,error:s}=await I(t,e);if(n){const o=a.map(l=>{const[c,h]=l.split(":").map(Number),i=new Date;i.setHours(c),i.setMinutes(h+90);const f=String(i.getHours()).padStart(2,"0"),m=String(i.getMinutes()).padStart(2,"0"),v=`${f}:${m}`;return{value:l,label:`${l} - ${v}`}});q(T,o)}else console.error("Failed to load available times:",s)}catch(n){console.error("Error loading available times:",n)}},Z=t=>{const e=D(t.target.value);t.target.setCustomValidity(e?"":"Please enter a valid email address.")},O=t=>{const e=t.target.value.trim();e.length===0?t.target.setCustomValidity("Name should not be empty or contain only spaces."):/^[a-zA-Z\s]{2,}$/.test(e)?t.target.setCustomValidity(""):t.target.setCustomValidity("Please enter a valid name (letters only, at least 2 characters).")},j=async t=>{t.preventDefault(),console.log("Selected Date:",d),console.log("Challenge ID:",r);const e=p.value.trim();if(e.length===0){p.setCustomValidity("Name should not be empty."),p.reportValidity();return}else p.setCustomValidity("");const n=u.value.trim();if(D(n))u.setCustomValidity("");else{u.setCustomValidity("Please enter a valid email address."),u.reportValidity();return}if(!d||!r){b("Missing challenge ID or selected date.");return}const a={challengeId:r,name:e,email:n,date:d,time:C.selected_time.value,participants:parseInt(C.selected_participants.value,10)};try{const{success:s,data:o,error:l}=await N(a);s?(console.log("Reservation created successfully:",o),p.value="",u.value="",T.selectedIndex=0,$.selectedIndex=0,k(3)):(console.error("Failed to create reservation:",l),b("Failed to create reservation. Please try again."))}catch(s){console.error("Error creating reservation:",s),b("An unexpected error occurred. Please try again.")}};document.addEventListener("DOMContentLoaded",()=>{u.addEventListener("input",Z),p.addEventListener("input",O)});C._hasSubmitListener||(C.addEventListener("submit",j),C._hasSubmitListener=!0);const M=document.querySelector(".booking-modal");document.querySelectorAll(".booking-modal__step");const _=document.querySelector(".custom__date"),w=document.querySelector(".modal__content-loading"),U=document.querySelector(".booking__search-btn"),Y=document.querySelectorAll(".close");let g;const J=()=>{const t=new Date;t.setDate(t.getDate()+1);const e=t.toISOString().split("T")[0];_.setAttribute("min",e)},k=t=>{document.querySelectorAll(".booking-modal__step").forEach((n,a)=>{a+1===t?(n.style.display="block",n.classList.add("booking-modal__step--active")):(n.style.display="none",n.classList.remove("booking-modal__step--active"))})},G=async t=>{try{const{success:e,data:n}=await y(t);e&&n.title?w.textContent=n.title:w.textContent="Room Title Not Found"}catch(e){w.textContent="Error Loading Room Title",console.error("Error loading room title:",e)}};U.addEventListener("click",async t=>{t.preventDefault();const e=_.value;if(!e){alert("Please select a valid date."),_.focus();return}if(!g){console.error("Error: challengeId is undefined.");return}await H(g,e)});const S=t=>{if(g=t,!g){console.error("No challengeId provided to openBookingModal");return}M.style.display="block",console.log(`Modal is displayed for challengeId: ${g}`),G(g),k(1)};document.addEventListener("DOMContentLoaded",()=>{M.style.display="none",console.log("Modal is hidden when the page is loaded"),J()});Y.forEach(t=>{t.addEventListener("click",()=>{const e=t.closest(".booking-modal");e.style.display="none"})});const K=(t,e)=>{if(t.length<=e)return t;const n=t.slice(0,e).trimEnd(),a=n.lastIndexOf(" ");return a>0?n.slice(0,a)+"...":n+"..."},Q="data:image/svg+xml,%3csvg%20width='23'%20height='23'%20viewBox='0%200%2023%2023'%20fill='none'%20xmlns='http://www.w3.org/2000/svg'%3e%3cpath%20d='M5.40931%202.38128C6.02509%200.24596%209.05071%200.24596%209.66648%202.38128C9.93999%203.32972%2010.808%203.98278%2011.7951%203.98278H11.9036C14.1208%203.98278%2015.1139%206.76375%2013.3983%208.1682L12.9618%208.5255C12.214%209.13762%2011.9029%2010.1364%2012.1706%2011.0649L12.3847%2011.8073C12.9762%2013.8584%2010.5678%2015.4459%208.91606%2014.0937C8.11445%2013.4375%206.96134%2013.4375%206.15973%2014.0937C4.50795%2015.4459%202.09958%2013.8584%202.69106%2011.8074L2.90517%2011.0649C3.17293%2010.1364%202.86176%209.13762%202.114%208.5255L1.67753%208.1682C-0.0381234%206.76374%200.954986%203.98278%203.17219%203.98278H3.28072C4.2678%203.98278%205.13581%203.32972%205.40931%202.38128Z'%20fill='%23E3170A'/%3e%3cclipPath%20id='half-mask'%3e%3crect%20x='11.5'%20y='0'%20width='11.5'%20height='23'%20/%3e%3c/clipPath%3e%3c/svg%3e",W="data:image/svg+xml,%3c?xml%20version='1.0'%20encoding='utf-8'?%3e%3csvg%20width='23'%20height='23'%20viewBox='0%200%2023%2023'%20fill='none'%20xmlns='http://www.w3.org/2000/svg'%3e%3cdefs%3e%3cclipPath%20id='half-mask'%3e%3crect%20x='8'%20y='0'%20width='11.5'%20height='23'%20/%3e%3c/clipPath%3e%3c/defs%3e%3cpath%20d='M%205.409%2012.994%20C%206.025%2015.13%209.051%2015.13%209.666%2012.994%20C%209.94%2012.046%2010.808%2011.393%2011.795%2011.393%20L%2011.904%2011.393%20C%2014.121%2011.393%2015.114%208.612%2013.398%207.207%20L%2012.962%206.85%20C%2012.214%206.238%2011.903%205.239%2012.171%204.311%20L%2012.385%203.568%20C%2012.976%201.517%2010.568%20-0.07%208.916%201.282%20C%208.114%201.938%206.961%201.938%206.16%201.282%20C%204.508%20-0.07%202.099%201.517%202.691%203.568%20L%202.905%204.311%20C%203.173%205.239%202.862%206.238%202.114%206.85%20L%201.677%207.207%20C%20-0.038%208.612%200.955%2011.393%203.172%2011.393%20L%203.281%2011.393%20C%204.268%2011.393%205.136%2012.046%205.409%2012.994%20Z'%20clip-path='url(%23half-mask)'%20style='fill:%20rgb(227,%2023,%2010);%20transform-origin:%2011.134px%207.68797px;'%20transform='matrix(-1,%200,%200,%20-1,%20-7.192186824964,%20-0.000001432395)'/%3e%3c/svg%3e",X="data:image/svg+xml,%3csvg%20width='23'%20height='23'%20viewBox='0%200%2023%2023'%20fill='none'%20xmlns='http://www.w3.org/2000/svg'%3e%3cpath%20d='M6.22343%202.65837C6.56124%201.48693%208.2211%201.48693%208.55891%202.65837C8.95588%204.03492%2010.2157%204.98278%2011.6483%204.98278H11.7569C13.0344%204.98278%2013.6066%206.58516%2012.6181%207.39441L12.1816%207.7517C11.1244%208.61714%2010.6845%2010.0292%2011.0631%2011.342L11.2772%2012.0844C11.5968%2013.1928%2010.2954%2014.0506%209.40277%2013.3199C8.23273%2012.3621%206.54961%2012.3621%205.37957%2013.3199C4.48698%2014.0506%203.18555%2013.1928%203.50518%2012.0844L3.71928%2011.342C4.09785%2010.0292%203.65791%208.61714%202.60071%207.7517L2.16424%207.3944C1.17569%206.58516%201.74791%204.98278%203.02546%204.98278H3.13399C4.56664%204.98278%205.82646%204.03492%206.22343%202.65837Z'%20stroke='%23E3170A'%20stroke-width='2'/%3e%3c/svg%3e";class ee{constructor(e,n,a,s,o,l,c,h,i){this.id=e,this.title=n,this.description=a,this.type=s,this.minParticipants=o,this.maxParticipants=l,this.rating=c,this.image=h,this.labels=i}createChallengeStars(){const e=this.rating,n=document.createElement("div");n.className="challenge__ratings";for(let a=1;a<=5;a++){const s=new Image;if(a<=Math.floor(e))s.src=Q,s.className="star filled";else if(a===Math.ceil(e)&&e%1!==0)s.src=W,s.className="star half";else if(e===0)return s.src=X,s.className="star unfilled",n.appendChild(s),n;n.appendChild(s)}return n}createBookChallengeBtn(){const e=document.createElement("button");return e.className="challenge__btn",this.type==="onsite"?(e.textContent="Book this room",e.addEventListener("click",()=>S(this.id))):this.type==="online"&&(e.textContent="Take challenge online",e.addEventListener("click",()=>S(this.id))),e}createChallengeCard(e){const n=document.createElement("li");n.id="challenges__carousel__slide"+this.id,n.setAttribute("tabindex",0),n.className="challenge__slide challengey challenges";const a=document.createElement("div");a.className="challenge__image-container";const s=document.createElement("img");s.className="challenge__img",s.src=this.image,s.alt=this.description,s.loading="lazy",a.appendChild(s);const o=document.createElement("div");o.className="challenge__details";const l=document.createElement("h2");l.className="challenge__details__title_temporary",l.textContent=this.title+(this.type==="onsite"?" (onsite)":"");const c=document.createElement("div");c.className="challenge__details-info";const h=this.createChallengeStars(),i=document.createElement("div");i.className="challenge__participants",i.textContent=`${this.minParticipants} - ${this.maxParticipants} participants`,this.type==="online"&&(i.textContent+=" (networked)"),a.appendChild(h),c.appendChild(i);const f=document.createElement("p");if(f.className="challenge__description",f.textContent=K(this.description,50),o.appendChild(l),this.labels&&this.labels.length>0){const v=this.createLabels();o.appendChild(v)}o.appendChild(c),o.appendChild(f),e&&o.appendChild(this.createBookChallengeBtn());const m=document.createElement("span");return m.className="challenge__type-icon",this.type==="online"?m.textContent="💻":this.type==="onsite"&&(m.textContent="🏠"),a.appendChild(m),n.appendChild(a),n.appendChild(o),n}createLabels(){const e=document.createElement("div");return e.className="challenge__labels",this.labels.forEach(n=>{const a=document.createElement("span");a.className="challenge__label",a.textContent=`*${n} `,e.appendChild(a)}),e}}const ne=(t,e,n=!0)=>{e.innerHTML="",t.forEach(a=>{const o=new ee(a.id,a.title,a.description,a.type,a.minParticipants,a.maxParticipants,a.rating,a.image,a.labels).createChallengeCard(n);e.appendChild(o)})};export{L as f,ne as r};
//# sourceMappingURL=renderChallenges-BQDNUyFF.js.map
